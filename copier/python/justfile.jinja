# Show available recipes.
default:
  @just --list

# Bootstrap the project (git init, deps, hooks).
init:
  if [ ! -d .git ]; then git init; fi
  uv sync
  pre-commit install --install-hooks

# Run tests.
test:
  uv run pytest -q

# Run all pre-commit checks.
check:
  pre-commit run --all-files

# Create a GitHub repository and set origin.
repo-create name='{{ project_name }}' visibility='{{ github_visibility }}': init
  case "{% raw %}{{visibility}}{% endraw %}" in public|private|internal) ;; *) echo "visibility must be one of: public, private, internal"; exit 2 ;; esac
  if ! gh auth status >/dev/null 2>&1; then gh auth login; fi
  gh repo create "{% raw %}{{name}}{% endraw %}" --source=. --remote=origin --"{% raw %}{{visibility}}{% endraw %}"

# Remove development caches and build artifacts.
clean:
  rm -rf .venv .mypy_cache .pytest_cache .ruff_cache .pre-commit-cache
  rm -rf .coverage .coverage.* htmlcov
  rm -rf build dist *.egg-info
  find . -type d -name "__pycache__" -exec rm -rf {} +
